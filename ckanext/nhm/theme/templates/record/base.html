{% from 'macros/record.html' import field_row %}
{% extends "package/base.html" %}

{% set rec = c.record_dict  %}
{% set res = c.resource %}
{% set pkg = c.pkg_dict or pkg_dict %}

{% block head_extras -%}
  {{ super() }}
  <meta property="og:title" content="{{ h.dataset_display_name(c.package) }} - {{ h.resource_display_name(res) }} - {{ record_name }} - {{ g.site_title }}">
{% endblock -%}

{% block subtitle %}{{ h.dataset_display_name(c.package) }} - {{ h.resource_display_name(res) }} - {{record_name}} {% endblock %}

{% block breadcrumb_content_selected %}{% endblock %}

{% block breadcrumb_content %}
  {{ super() }}
  <li>{% link_for h.resource_display_name(res)|truncate(40), controller='package', action='resource_read', id=pkg.name, resource_id=res.id %}</li>
  <li class="active"><a href="">{{ record_name|truncate(30) }}</a></li>
{% endblock %}

{% block pre_primary %}
    <section class="module module-resource">
        <div class="module-content">
            <div class="actions">
                <ul>
                    <li><a class="btn btn-primary resource-url-analytics resource-type-{{ res.resource_type }}"><i class="icon-download"></i> {{ _('Download') }}</a></li>
                </ul>
            </div>

            <h1 class="page-heading">{{ record_name|truncate(50) }}</h1>

            <div class="record-content">
            {% block record_content %}

            <table>

                {% for field_name in rec: %}

                    {% if rec[field_name]: %}

                        {{ field_row(field_name, rec[field_name]) }}

                    {% endif %}

                {% endfor %}

            </table>

            {% endblock %}

            </div>

        </div>
    </section>
{% endblock %}

{% block primary_content %}
    {% block record_additional_information %}
        <section class="module">
            <div class="module-content">
              <h2>{{ _('Additional Information') }}</h2>
              <table class="table table-striped table-bordered table-condensed" data-module="table-toggle-more">
                <thead>
                  <tr>
                    <th scope="col">{{ _('Field') }}</th>
                    <th scope="col">{{ _('Value') }}</th>
                  </tr>
                </thead>
                <tbody>

                  {% block record_additional_information_rows %}
                       <tr>
                        <th scope="row">{{ _('Format') }}</th>
                        <td>{{ res.mimetype_inner or res.mimetype or res.format or _('unknown') }}</td>
                      </tr>
                      <tr>
                        <th scope="row">{{ _('License') }}</th>
                        <td>{% snippet "snippets/license.html", pkg_dict=pkg, text_only=True %}</td>
                      </tr>
                      <tr class="toggle-more">
                        <th scope="row">{{ _('Dataset') }}</th>
                        <td>{{ pkg.name }}</td>
                      </tr>
                      <tr class="toggle-more">
                        <th scope="row">{{ _('Dataset ID') }}</th>
                        <td>{{ pkg.id }}</td>
                      </tr>
                      <tr class="toggle-more">
                        <th scope="row">{{ _('Resource') }}</th>
                        <td>{{ res.name }}</td>
                      </tr>
                      <tr class="toggle-more">
                        <th scope="row">{{ _('Resource ID') }}</th>
                        <td>{{ res.id }}</td>
                      </tr>
                      <tr class="toggle-more">
                        <th scope="row">{{ _('Status') }}</th>
                        <td>{{ rec.status or _('unknown') }}</td>
                      </tr>
                  {% endblock %}

                </tbody>
              </table>
            </div>
          </section>

    {% endblock %}
{% endblock %}

{% block secondary_content %}

  {% block resource_license %}
    {% snippet "snippets/social.html" %}
  {% endblock %}

{% endblock %}